System.register("chunks:///_virtual/Room_2",["./Room_2.ts"],(function(){return{setters:[null],execute:function(){}}}));

System.register("chunks:///_virtual/Room_2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UI.ts","./Room_UI.ts","./Card.ts","./Global.ts","./Room.ts","./Wasm.ts","./Player.ts"],(function(e){var t,i,a,s,r,n,o,l,h,d,c,u,m,v,p,g,f,C,y,_,w,S,A,b,k,N,T;return{setters:[function(e){t=e.inherits,i=e.createSuper,a=e.classCallCheck,s=e.defineProperty,r=e.assertThisInitialized,n=e.createClass,o=e.get,l=e.getPrototypeOf},function(e){h=e.cclegacy,d=e._decorator,c=e.CacheMode,u=e.Color,m=e.assetManager,v=e.BufferAsset,p=e.director,g=e.Label},function(e){f=e.createNode,C=e.appendLabel,y=e.mycolor,_=e.createMsgbox},function(e){w=e.Template4},function(e){S=e.Card},function(e){A=e.mylang,b=e.mygame},function(e){k=e.Room},function(e){N=e.Wasm},function(e){T=e.Player}],execute:function(){var B;h._RF.push({},"4b1f48eT6JHNp8KbbouJEs2","Room_2",void 0);var I=d.ccclass;e("Room_2",I("Room_2")(B=function(e){t(d,e);var h=i(d);function d(){var e;a(this,d);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return e=h.call.apply(h,[this].concat(i)),s(r(e),"TipsNodes",new Array(14)),s(r(e),"TipsCur",void 0),e}return n(d,[{key:"init",value:function(e,t){var i=this,a=f("Pass",this.Opt,.465,.465,.55,.37,!1,void 0,this.node);C(a,A.room.pass,64,y,void 0,1),a=f("Bump",this.Opt,.325,.605,.55,.37,!1,void 0,this.node),C(a,A.room.bump,64,y,void 0,1),a=f("NoBump",this.Opt,.605,.325,.55,.37,!1,void 0,this.node),C(a,A.room.nobump,64,y,void 0,1),a=f("Score",this.node,.02,.825,.025,.85);var s=f("Label",a,0,.7,0,.67);C(s,A.room.ownside,26,u.MAGENTA,c.BITMAP,1),s=f("Total1",a,.3,.33,0,.67),C(s,"0",30,u.MAGENTA,void 0,void 0,void 0,void 0,void 0,e),s=f("Score1",a,.67,0,0,.67),C(s,"0",30,u.MAGENTA,void 0,void 0,void 0,void 0,void 0,e),s=f("Label",a,0,.7,.33,.33),C(s,A.room.otherside,26,y,c.BITMAP,1),s=f("Total2",a,.3,.33,.33,.33),C(s,"0",30,y,void 0,void 0,void 0,void 0,void 0,e),s=f("Score2",a,.67,0,.33,.33),C(s,"0",30,y,void 0,void 0,void 0,void 0,void 0,e),s=f("Current",a,0,.7,.67,0),C(s,"0",30,u.RED,void 0,void 0,void 0,void 0,void 0,e),s=f("Label",a,.3,.33,.67,0),C(s,A.room.total,26,u.RED,c.BITMAP,1),s=f("Label",a,.67,0,.67,0),C(s,A.room.game,26,u.RED,c.BITMAP,1),w(e,this.node,this.curAreas,this.small_curAreas,this.outAreas,t);for(var r=0;r<14;r+=1)this.TipsNodes[r]=f("Label",null,.05,.73,.32,.48),C(this.TipsNodes[r],"",24,u.BLUE,void 0,void 0,void 0,void 0,void 0,e);this.TipsCur=f("Label",null,.34,.34,.2,.55),C(this.TipsCur,"",36,u.BLUE,void 0,void 0,void 0,void 0,void 0,e);for(var n=0;n<this.gamers;n+=1)this.all_players[n]=this.node.getChildByName("Player"+n).getComponent(T);var o=this;this.importObj={imports:{imported_func:function(e,t,i,a,s,r){switch(e){case 2:o.insertCard(t,i);break;case 4:o.Countdown_Discard(t,i,Boolean(a)),0===t&&0!==s&&(0===a?(o.Opt.getChildByName("Discard").active=!1,o.Opt.getChildByName("NoBump").active=!0,2===r&&(o.Opt.getChildByName("Bump").active=!0)):o.Opt.getChildByName("Pass").active=!0),1===r&&(o.playstep+=1,o.handArea.resumeSystemEvents(!1));break;case 5:o.SetScore(t,i);break;case 6:o.SetCurrent(t);break;case 7:o.setPlayer(t,i,a);break;case 8:o.CurToOut(t);break;case 9:o.End();break;case 11:o.setBanker(t);break;case 12:o.Deal();break;case 13:o.SetTotal(t,i);break;case 17:o.Countdown_Start(t);break;case 19:o.handArea.resumeSystemEvents(!1);break;case 21:o.ResumeAllCards()}}}},m.getBundle("Room_2").load("room_2",v,(function(e,t){e||(i.AI=new N(t.buffer(),512,i.importObj),p.emit("Ready"))}))}},{key:"ResetRoom",value:function(){this.ClearRoom(),this.netstep=0,this.showout=!1,this.SetScore(0,0),this.SetTotal(0,0)}},{key:"PreDeal",value:function(){}},{key:"Handle_Wrong_Choose",value:function(e,t){1!==e?2!==e||_(A.room.small):_(A.room.illegal)}},{key:"handle_play",value:function(e,t,i){var a=this;if(t.forEach((function(e,t){return a.AI.wasm_view.setUint8(t,e)})),this.call_wasm_func(13,t.length),0===this.AI.wasm_view.getUint8(0)){if(t.length>0){var s=this.AI.wasm_view.getUint8(1);this.CurToOut(s);var r=this.showout?this.small_curAreas[e]:this.curAreas[e];0===e?(t.forEach((function(e){var t=a.handArea.children.findIndex((function(t){return t.getComponent(S).face===e}));a.showout&&a.handArea.children[t].setScale(a.scale,a.scale,1),a.handArea.children[t].getComponent(S).selected=!1,a.handArea.children[t].parent=r})),this.ShowHand(!0)):t.forEach((function(e){var t=a.getFreeCard(e);a.showout&&a.all_cards[t].node.setScale(a.scale,a.scale,1),a.all_cards[t].node.parent=r})),this.resortChildren(r),this.showCards(r)}0===e?(this.timer.getComponent(g).string="",this.Opt.children.forEach((function(e){return e.active=!1}))):i&&(this.all_players[e].isAi=!1),this.playstep+=1,this.call_wasm_func(14)}else i&&(this.all_players[e].isAi=!0,this.Discard(e))}},{key:"ResumeAllCards",value:function(){var e=0,t=this.AI.wasm_view.getUint8(e);e+=1;for(var i=0;i<t;i+=1)this.all_cards[this.getFreeCard(this.AI.wasm_view.getUint8(e+i))].node.parent=this.handArea;e+=t;for(var a=this.scale,s=0;s<this.gamers;s+=1){t=this.AI.wasm_view.getUint8(e),e+=1;for(var r,n=0;n<t;n+=1)r=this.getFreeCard(this.AI.wasm_view.getUint8(e+n)),this.all_cards[r].node.setScale(a,a,1),this.all_cards[r].node.parent=this.outAreas[s];0!==s&&this.showCards(this.outAreas[s],!0),e+=t}this.ShowHand(!0,!1),t=this.AI.wasm_view.getUint8(e),e+=1;var o=this.AI.wasm_view.getUint8(e);e+=1;for(var l=0;l<t;l+=1)this.all_cards[this.getFreeCard(this.AI.wasm_view.getUint8(e+l))].node.parent=this.curAreas[o];this.resortChildren(this.curAreas[o]),this.showCards(this.curAreas[o]),e+=t}},{key:"call_wasm_func",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;switch(e){case 13:this.AI.call_wasm_func(13,t);break;case 14:this.AI.call_wasm_func(14);break;case 17:this.AI.call_wasm_func(17);break;default:o(l(d.prototype),"call_wasm_func",this).call(this,e,t)}}},{key:"onChoosed",value:function(e){switch(e.propagationStopped=!0,e.detail){case"Pass":case"NoBump":this.Opt.pauseSystemEvents(!1),b.alone?p.emit("ManagerMsg","play",this.all_players[0].playerid,this.playstep,[],!1):this.SendCards([]);break;case"Bump":this.Opt.pauseSystemEvents(!1);var t=new Array(2);this.call_wasm_func(5),t[0]=this.AI.wasm_view.getUint8(0),t[1]=this.AI.wasm_view.getUint8(1),b.alone?p.emit("ManagerMsg","play",b.playerid,this.playstep,t,!1):this.SendCards(t);break;default:o(l(d.prototype),"onChoosed",this).call(this,e)}}},{key:"ShowHand",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.showout,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.handArea;o(l(d.prototype),"ShowHand",this).call(this,t,i,a),this.TipsNodes.forEach((function(e){return e.parent=null}));var s=a.children.findIndex((function(e){return 1!==e.scale.x})),r=-1===s?a.children.length:s;if(!(r<5)){var n=a.children.findIndex((function(e,t){return Number(e.name)<53&&t<r}));if(-1===n)return this.TipsNodes[0].getComponent(g).string=String(r),void(this.TipsNodes[0].parent=a.children[r-1]);for(var h,c=[n,1],u=Number(a.children[n].name)%13,m=1,v=n+1;v<r;v+=1)(h=Number(a.children[v].name)%13)===u?c[m]+=1:(c.push(1),m+=1,u=h);var p=0;c.forEach((function(t,i){p+=t,t>4&&(e.TipsNodes[i].getComponent(g).string=String(t),e.TipsNodes[i].parent=a.children[p-1])}))}}},{key:"insertCard",value:function(e,t){var i=this.getFreeCard(e);this.all_cards[i].node.parent=this.handArea,this.all_cards[i].node.setSiblingIndex(t),this.ShowHand()}},{key:"CurToOut",value:function(e){var t=this;this.TipsCur.parent=null;var i=this.showout?this.small_curAreas[e]:this.curAreas[e];this.showout||i.children.forEach((function(e){return e.setScale(t.scale,t.scale,1)})),this.relocation(i,this.outAreas[e]),0===e?this.ShowHand():this.showCards(this.outAreas[e],!this.showout)}},{key:"End",value:function(){var e=this;if(!b.alone){this.delayid=setTimeout((function(){e.delayid=0,p.emit("WsRequest","end")}),500*this.DelayNum())}this.timerid=setTimeout((function(){e.timerid=0,e.ClearRoom(),e.SetScore(0,0),e.all_players.forEach((function(e){return e.labelTopRight=""})),e.call_wasm_func(17)}),2e3)}},{key:"setBanker",value:function(e){this.all_players.forEach((function(t,i){t.labelRight=i===e?A.room.banker:""}))}},{key:"SetCurrent",value:function(e){this.node.getChildByName("Score").getChildByName("Current").getComponent(g).string=String(e)}},{key:"SetScore",value:function(e,t){this.node.getChildByName("Score").getChildByName("Score1").getComponent(g).string=String(e),this.node.getChildByName("Score").getChildByName("Score2").getComponent(g).string=String(t),this.node.getChildByName("Score").getChildByName("Current").getComponent(g).string="0"}},{key:"SetTotal",value:function(e,t){this.node.getChildByName("Score").getChildByName("Total1").getComponent(g).string=String(e),this.node.getChildByName("Score").getChildByName("Total2").getComponent(g).string=String(t)}},{key:"resortChildren",value:function(e){if(!(e.children.length<3)){for(var t=e.children.map((function(e){return e.getComponent(S).face})),i=e.children.length,a=t.map((function(e){return String(e%13)})),s=0;s<i;s+=1)switch(a[s]){case"12":a[s]="C";break;case"11":a[s]="B";break;case"10":a[s]="A";break;case"2":54===t[s]&&(a[s]="E");break;case"1":53===t[s]&&(a[s]="D")}var r=a.join("");/^2211.*33$/.test(r)?(e.children[0].setSiblingIndex(-1),e.children[0].setSiblingIndex(-1),e.children[0].setSiblingIndex(-1),e.children[0].setSiblingIndex(-1)):/^21.*3$/.test(r)||/^22.*33$/.test(r)?(e.children[0].setSiblingIndex(-1),e.children[0].setSiblingIndex(-1)):/^2.*3$/.test(r)&&e.children[0].setSiblingIndex(-1),i>4&&(this.TipsCur.getComponent(g).string=String(i),this.TipsCur.parent=e.children[i-1])}}}]),d}(k))||B);h._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/Room_2', 'chunks:///_virtual/Room_2'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});
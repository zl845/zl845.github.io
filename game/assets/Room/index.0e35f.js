System.register("chunks:///_virtual/Card.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r,n,a,c,s,i,o,u,l;return{setters:[function(e){t=e.inherits,r=e.createSuper,n=e.classCallCheck,a=e.defineProperty,c=e.assertThisInitialized,s=e.createClass},function(e){i=e.cclegacy,o=e._decorator,u=e.Sprite,l=e.Component}],execute:function(){var f;i._RF.push({},"c2d3fys7iNOb7OKD2qbujFo","Card",void 0);var d=o.ccclass;e("Card",d("Card")(f=function(e){t(o,e);var i=r(o);function o(){var e;n(this,o);for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e=i.call.apply(i,[this].concat(r)),a(c(e),"selected",!1),a(c(e),"_face",0),e}return s(o,[{key:"face",get:function(){return this._face},set:function(e){this.node.getComponent(u).spriteFrame=e,0===this._face&&(this.node.name=e.name,this._face=Number(e.name))}}]),o}(l))||f);i._RF.pop()}}}));

System.register("chunks:///_virtual/Info.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts"],(function(n){var e,t,c,i,o,r,s,a,l,u,h;return{setters:[function(n){e=n.inherits,t=n.createSuper,c=n.classCallCheck,i=n.defineProperty,o=n.assertThisInitialized,r=n.createClass},function(n){s=n.cclegacy,a=n._decorator,l=n.Label,u=n.Component},function(n){h=n.mylang}],execute:function(){var f;s._RF.push({},"0ef71/oxi1NGJgR1prs1IRt","Info",void 0);var d=a.ccclass;n("Info",d("Info")(f=function(n){e(a,n);var s=t(a);function a(){var n;c(this,a);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n=s.call.apply(s,[this].concat(t)),i(o(n),"chosen_id",0),n}return r(a,[{key:"setInfo",value:function(n,e){this.chosen_id=n,this.node.children[0].getComponent(l).string="".concat(h.begin.id,":").concat(n,"\n").concat(h.begin.intro,":").concat(e),this.node.children[1].active=!1,this.node.children[2].active=!1}},{key:"selected",value:function(){return this.chosen_id}}]),a}(u))||f);s._RF.pop()}}}));

System.register("chunks:///_virtual/Player.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MyEvent.ts","./Global.ts"],(function(e){var t,n,i,o,a,h,s,l,r,d,g,c,u;return{setters:[function(e){t=e.inherits,n=e.createSuper,i=e.classCallCheck,o=e.defineProperty,a=e.assertThisInitialized,h=e.createClass},function(e){s=e.cclegacy,l=e._decorator,r=e.Label,d=e.Node,g=e.Component},function(e){c=e.MyEvent},function(e){u=e.emoji_to_char}],execute:function(){var y;s._RF.push({},"f6bbf5yRH9Gj7JdqT7z6O4p","Player",void 0);var f=l.ccclass;e("Player",f("Player")(y=function(e){t(l,e);var s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),h=0;h<t;h++)n[h]=arguments[h];return e=s.call.apply(s,[this].concat(n)),o(a(e),"isAi",!1),o(a(e),"_playerid",0),o(a(e),"_nickname",""),o(a(e),"_introduce",""),o(a(e),"_head",""),e}return h(l,[{key:"playerid",get:function(){return this._playerid}},{key:"nickname",get:function(){return this._nickname}},{key:"introduce",get:function(){return this._introduce}},{key:"head",get:function(){return this._head}},{key:"labelRight",get:function(){return this.node.getChildByName("Head").getChildByName("Right").getComponent(r).string},set:function(e){this.node.getChildByName("Head").getChildByName("Right").getComponent(r).string=e}},{key:"labelLeft",get:function(){return this.node.getChildByName("Head").getChildByName("Left").getComponent(r).string},set:function(e){this.node.getChildByName("Head").getChildByName("Left").getComponent(r).string=e}},{key:"labelTopRight",get:function(){return this.node.getChildByName("Head").getChildByName("TRight").getComponent(r).string},set:function(e){this.node.getChildByName("Head").getChildByName("TRight").getComponent(r).string=e}},{key:"labelTopLeft",get:function(){return this.node.getChildByName("Head").getChildByName("TLeft").getComponent(r).string},set:function(e){this.node.getChildByName("Head").getChildByName("TLeft").getComponent(r).string=e}},{key:"onEnable",value:function(){this.node.on(d.EventType.TOUCH_END,this.onChoose,this)}},{key:"onDisable",value:function(){this.node.off(d.EventType.TOUCH_END,this.onChoose,this)}},{key:"onChoose",value:function(){this.node.dispatchEvent(new c("Choosed",!0,"Seat"))}},{key:"SetPlayerInfo",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"ðŸˆ³";this._playerid=e,this._nickname=t,this._introduce=n,this._head=i,this.isAi=!(e>6||0===e),this.node.getChildByName("Label").getComponent(r).string=t,this.node.getChildByName("Head").getComponent(r).string=u(i)}},{key:"clear",value:function(){this.labelTopLeft="",this.labelTopRight="",this.labelRight="",this.labelLeft=""}}]),l}(g))||y);s._RF.pop()}}}));

System.register("chunks:///_virtual/Room",["./Card.ts","./Info.ts","./Player.ts","./Room.ts","./Room_UI.ts"],(function(){return{setters:[null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/Room_UI.ts",["cc","./UI.ts","./Card.ts"],(function(r){var e,u,a,t,n,p,s,A,h,o,i,l;return{setters:[function(r){e=r.cclegacy,u=r.CacheMode,a=r.Color,t=r.HorizontalTextAlignment,n=r.Node,p=r.Layers,s=r.UITransform},function(r){A=r.createNode,h=r.appendLabel,o=r.mycolor,i=r.appendSprite},function(r){l=r.Card}],execute:function(){function C(r,e,n,p,s,i,l,C){var d=A(r,e,n,p,s,i,void 0,"Player"),c=A("Label",d,0,0,.66,0);h(c,"",16,a.BLACK,u.BITMAP,1),c=A("Head",d,0,0,0,.34),h(c,"ç©º",60,a.WHITE,u.BITMAP,void 0,void 0,void 0,void 0,C);var y=A("Left",c,0,.5,.55,0);h(y,"",25,o,u.NONE,1,t.LEFT),y=A("Right",c,.5,0,.55,0),h(y,"",25,a.MAGENTA,u.NONE,1,t.RIGHT),y=A("TLeft",c,0,.5,0,.55),h(y,"",25,a.BLUE,void 0,void 0,t.LEFT,void 0,void 0,l),y=A("TRight",c,.5,0,0,.55),h(y,"",25,a.RED,void 0,void 0,t.RIGHT,void 0,void 0,l)}r({Template2:function(r,e,u,a,t,n){C("Player0",e,.025,.92,.87,.025,r,n),C("Player1",e,.92,.025,.025,.87,r,n);var p=A("CurrentMinor",e,.25,.25,.2,.3);a.push(A("Area0",p,0,0,13/18,0)),a.push(A("Area1",p,0,0,0,13/18)),t.push(A("OutArea1",e,.1875,.1875,0,.8)),u.push(A("CurrentArea0",e,.25,.25,.46,.34)),u.push(A("CurrentArea1",e,.25,.25,.02,.78))},Template3:function(r,e,u,a,t,n){C("Player0",e,.025,.92,.87,.025,r,n),C("Player1",e,.92,.025,.4475,.4475,r,n),C("Player2",e,.025,.92,.025,.87,r,n);var p=A("CurrentMinor",e,.25,.25,.2,.3);a.push(A("Area0",p,0,0,13/18,0)),a.push(A("Area1",p,.5,0,5/18,5/18)),a.push(A("Area2",p,0,0,0,13/18)),t.push(A("OutArea1",e,.75,0,.2,.3)),t.push(A("OutArea2",e,.1875,.1875,0,.8)),u.push(A("CurrentArea0",e,.25,.25,.46,.34)),u.push(A("CurrentArea1",e,.5,0,.24,.56)),u.push(A("CurrentArea2",e,.25,.25,.02,.78))},Template4:function(r,e,u,a,t,n){C("Player0",e,.025,.92,.87,.025,r,n),C("Player1",e,.92,.025,.4475,.4475,r,n),C("Player2",e,.92,.025,.025,.87,r,n),C("Player3",e,.025,.92,.4475,.4475,r,n);var p=A("CurrentMinor",e,.25,.25,.2,.3);a.push(A("Area0",p,0,0,13/18,0)),a.push(A("Area1",p,.5,0,5/18,5/18)),a.push(A("Area2",p,0,0,0,13/18)),a.push(A("Area3",p,0,.5,5/18,5/18)),t.push(A("OutArea1",e,.75,0,.2,.3)),t.push(A("OutArea2",e,.1875,.1875,0,.8)),t.push(A("OutArea3",e,0,.75,.2,.3)),u.push(A("CurrentArea0",e,.25,.25,.46,.34)),u.push(A("CurrentArea1",e,.5,0,.24,.56)),u.push(A("CurrentArea2",e,.25,.25,.02,.78)),u.push(A("CurrentArea3",e,0,.5,.24,.56))},Template5:function(r,e,u,a,t,n){C("Player0",e,.025,.92,.87,.025,r,n),C("Player1",e,.92,.025,.4475,.4475,r,n),C("Player2",e,.92,.025,.115,.78,r,n),C("Player3",e,.025,.92,.115,.78,r,n),C("Player4",e,.025,.92,.4475,.4475,r,n);var p=A("CurrentMinor",e,.25,.25,.2,.3);a.push(A("Area0",p,0,0,13/18,0)),a.push(A("Area1",p,.5,0,13/36,5/18)),a.push(A("Area2",p,.5,0,0,23/36)),a.push(A("Area3",p,0,.5,0,23/36)),a.push(A("Area4",p,0,.5,13/36,5/18)),t.push(A("OutArea1",e,.75,0,.2,.3)),t.push(A("OutArea2",e,.5,0,0,.8)),t.push(A("OutArea3",e,0,.5,0,.8)),t.push(A("OutArea4",e,0,.75,.2,.3)),u.push(A("CurrentArea0",e,.25,.25,.46,.34)),u.push(A("CurrentArea1",e,.5,0,.24,.56)),u.push(A("CurrentArea2",e,.5,0,.02,.78)),u.push(A("CurrentArea3",e,0,.5,.02,.78)),u.push(A("CurrentArea4",e,0,.5,.24,.56))},Template6:function(r,e,u,a,t,n){C("Player0",e,.025,.92,.87,.025,r,n),C("Player1",e,.935,.01,.545,.35,r,n),C("Player2",e,.935,.01,.285,.61,r,n),C("Player3",e,.935,.01,.025,.87,r,n),C("Player4",e,.01,.935,.025,.87,r,n),C("Player5",e,.01,.935,.285,.61,r,n);var p=A("CurrentMinor",e,.3,.3,.22,.28);a.push(A("Area0",p,0,.5,13/18,0)),a.push(A("Area1",p,.5,0,13/18,0)),a.push(A("Area2",p,.5,0,13/36,13/36)),a.push(A("Area3",p,.5,0,0,13/18)),a.push(A("Area4",p,0,.5,0,13/18)),a.push(A("Area5",p,0,.5,13/36,13/36)),t.push(A("OutArea1",e,.7,.08,.47,.26)),t.push(A("OutArea2",e,.7,.08,.2,.53)),t.push(A("OutArea3",e,.6,.08,0,.8)),t.push(A("OutArea4",e,.08,.6,0,.8)),t.push(A("OutArea5",e,.08,.7,.2,.53)),u.push(A("CurrentArea0",e,.08,.5,.54,.26)),u.push(A("CurrentArea1",e,.5,.08,.54,.26)),u.push(A("CurrentArea2",e,.5,.08,.28,.52)),u.push(A("CurrentArea3",e,.5,.08,.02,.78)),u.push(A("CurrentArea4",e,.08,.5,.02,.78)),u.push(A("CurrentArea5",e,.08,.5,.28,.52))},createCard:function(r,e){var u=new n("Card");u.layer=p.Enum.UI_2D;var a=u.addComponent(s);return a.setAnchorPoint(0,0),a.contentSize.set(e,r),i(u,null),u.addComponent(l)},createPlayer:C}),e._RF.push({},"8306daE0o1BiqDP1ouWcVTx","Room_UI",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/Room.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Card.ts","./Global.ts","./Info.ts","./UI.ts","./Room_UI.ts"],(function(e){var t,i,s,a,n,r,o,l,h,d,c,u,m,f,p,g,v,y,_,w,C,A,S,k,I,b,V,U,M,R,x,T;return{setters:[function(e){t=e.inherits,i=e.createSuper,s=e.classCallCheck,a=e.defineProperty,n=e.assertThisInitialized,r=e.createClass},function(e){o=e.cclegacy,l=e._decorator,h=e.Color,d=e.Vec2,c=e.Vec3,u=e.UITransform,m=e.Sprite,f=e.assetManager,p=e.resources,g=e.JsonAsset,v=e.SpriteAtlas,y=e.BitmapFont,_=e.director,w=e.Node,C=e.NodeEventType,A=e.Label,S=e.Widget,k=e.Component},function(e){I=e.Card},function(e){b=e.mygame,V=e.mylang,U=e.L10nLabels},function(e){M=e.Info},function(e){R=e.mycolor,x=e.createMsgbox},function(e){T=e.createCard}],execute:function(){var E;o._RF.push({},"ea4c7PFb8VBua8eGFYbeouR","Room",void 0);var N=l.ccclass,B=new h(187,187,187);e("Room",N("Room")(E=function(e){t(l,e);var o=i(l);function l(){var e;s(this,l);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return e=o.call.apply(o,[this].concat(i)),a(n(e),"netstep",0),a(n(e),"playstep",0),a(n(e),"last_send_restep",0),a(n(e),"last_get_playstep",0),a(n(e),"resuming",!1),a(n(e),"cardpics",new Array(55)),a(n(e),"gamers",b.playernum),a(n(e),"decks",b.pokernum),a(n(e),"all_cards",new Array(54*e.decks)),a(n(e),"all_players",new Array(e.gamers)),a(n(e),"countdown",0),a(n(e),"vpos",0),a(n(e),"myindex",0),a(n(e),"showout",!1),a(n(e),"frame",void 0),a(n(e),"info",void 0),a(n(e),"quit",void 0),a(n(e),"quit_pic",void 0),a(n(e),"ex",void 0),a(n(e),"opdelayid",0),a(n(e),"delayid",0),a(n(e),"timerid",0),a(n(e),"resumeid",0),a(n(e),"car_height",void 0),a(n(e),"scale",.6875),a(n(e),"out_screen",void 0),a(n(e),"startVec2",new d),a(n(e),"startVec3",new c),a(n(e),"endVec2",new d),a(n(e),"endVec3",new c),a(n(e),"handArea",void 0),a(n(e),"Opt",void 0),a(n(e),"auto",void 0),a(n(e),"timer",void 0),a(n(e),"outAreas",[]),a(n(e),"curAreas",[]),a(n(e),"small_curAreas",[]),a(n(e),"AI",void 0),a(n(e),"importObj",void 0),e}return r(l,[{key:"onLoad",value:function(){this.car_height=.2*this.node.getComponent(u).height,this.out_screen=Math.ceil(this.node.getComponent(u).height)<<2,this.ex=this.node.getChildByName("ex"),this.auto=this.node.getChildByName("Ai"),this.handArea=this.node.getChildByName("HandArea"),this.outAreas.push(this.handArea),this.Opt=this.node.getChildByName("Opt"),this.timer=this.node.getChildByName("Timer"),this.info=this.node.getChildByName("Info"),this.quit=this.node.getChildByName("Quit"),this.quit_pic=this.quit.getComponent(m).spriteFrame,this.frame=this.node.getChildByName("frame")}},{key:"start",value:function(){var e=this,t=f.getBundle("Room");p.load("l10n/"+V.select+"/room",g,(function(i,s){i||(V.room=s.json,U.forEach((function(e){return e.updateLabel()})),t.load("cards",v,(function(i,s){if(!i){s.getSpriteFrames().forEach((function(t){return e.cardpics[Number(t.name)]=t}));for(var a=e.car_height,n=.8*a,r=0;r<54;r+=1)for(var o,l=0;l<e.decks;l+=1)(o=T(a,n)).face=e.cardpics[r+1],e.all_cards[r*e.decks+l]=o;p.load("head",y,(function(i,s){i||t.load("lightcard",y,(function(t,i){t||(e.init(i,s),e.timer.setSiblingIndex(-1),e.info.setSiblingIndex(-1),e.quit.setSiblingIndex(-1),e.quit.getComponent(m).spriteFrame=null,_.on("Ready",e.AfterRoomReady,e),e.node.on("Choosed",e.onChoosed,e),e.handArea.on(w.EventType.TOUCH_END,e.touchend,e),e.node.on(C.SIZE_CHANGED,e.onResized,e))}))}))}})))}))}},{key:"onDisable",value:function(){U.length=0,this.opdelayid>0&&(clearTimeout(this.opdelayid),this.opdelayid=0),this.delayid>0&&(clearTimeout(this.delayid),this.delayid=0),this.timerid>0&&(clearTimeout(this.timerid),this.timerid=0),this.resumeid>0&&(clearTimeout(this.resumeid),this.resumeid=0),_.off("ManagerMsg",this.onManagerMsg,this),this.node.off("Choosed",this.onChoosed,this),this.handArea.off(w.EventType.TOUCH_END,this.touchend,this),this.node.off(C.SIZE_CHANGED,this.onResized,this)}},{key:"call_wasm_func",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;switch(e){case 0:this.AI.wasm_view.setUint8(0,this.gamers),this.AI.wasm_view.setUint8(1,this.decks),this.AI.wasm_view.setUint8(2,Math.floor(255*Math.random())),this.AI.wasm_view.setUint8(3,Math.floor(128*Math.random())),this.AI.call_wasm_func(0);break;case 1:this.AI.call_wasm_func(1);break;case 2:this.AI.call_wasm_func(2);break;case 3:this.AI.call_wasm_func(3);break;case 4:this.AI.call_wasm_func(4);break;case 5:this.AI.call_wasm_func(5,t);break;case 11:this.AI.call_wasm_func(11);break;case 99:this.AI.call_wasm_func(99);break;case 100:this.AI.call_wasm_func(100,t);break;case 101:this.AI.call_wasm_func(101,t),this.resuming=!1}}},{key:"ClearRoom",value:function(){this.playstep=0,this.all_cards.forEach((function(e){e.selected=!1,e.node.setScale(1,1,1),e.node.parent=null}))}},{key:"HandleMsg",value:function(e,t,i){var s=new DataView(e),a=2;if(41===t&&1===i){var n=s.getUint32(a);a+=4;s.getUint16(a);a+=2,this.last_get_playstep=s.getUint16(a),a+=2,this.netstep+=1;for(var r=s.byteLength-a,o=new Array(r),l=0;l<r;l+=1)o[l]=s.getUint8(a+l);a+=r,this.playstep===this.last_get_playstep&&this.timerid>0&&(clearTimeout(this.timerid),this.timerid=0),_.emit("ManagerMsg","play",n,this.last_get_playstep,o,!0)}}},{key:"onManagerMsg",value:function(e,t,i,s,a){var n=this;if("msg"===e){var r=new DataView(t),o=0,l=r.getUint8(o);o+=1;var h=r.getUint8(o);return o+=1,41===l||44===l?void this.HandleMsg(t,l,h):void 0}if("create"===e){if(this.myindex=1,b.super)return void _.emit("ManagerMsg","start");this.timerid>0&&(clearTimeout(this.timerid),this.timerid=0);var d=new DataView(t),c=1;return b.roomid=d.getUint32(c),c+=4,void this.Countdown_Start(V.games[b.gamenum].random?15:120)}if("start"!==e){if("deal"===e)return this.delayid>0&&(clearTimeout(this.delayid),this.delayid=0),this.AI.wasm_view.setUint8(0,0),this.PreDeal(),void this.call_wasm_func(2);if("play"!==e)if("end"!==e)if("leave"!==e);else{this.timerid>0&&(clearTimeout(this.timerid),this.timerid=0);var u=1,m=new DataView(t).getUint8(u);if(u+=1,0===m)f.loadBundle("Hall",(function(e,t){_.loadScene("GameHall")}));else{this.ResetRoom();for(var p=1;p<this.gamers;p+=1)this.all_players[p].SetPlayerInfo(0,"","")}}else this.delayid>0&&(clearTimeout(this.delayid),this.delayid=0);else this.preHandlePlay(t,i,s,a)}else{if(this.countdown=0,this.timer.getComponent(A).string="",this.handArea.pauseSystemEvents(!1),this.Opt.children.forEach((function(e){return e.active=!1})),0===this.netstep){this.call_wasm_func(0),b.alone=!0;for(var g,v=1;v<this.gamers;v+=1)0===this.all_players[v].playerid?((g=this.myindex+v)>this.gamers&&(g-=this.gamers),this.all_players[v].SetPlayerInfo(g,V.room.robot+String(g),V.room.robotinfo)):b.alone=!1;b.alone&&(b.roomid=0,this.netstep=1)}if(this.call_wasm_func(99),this.delayid>0&&(clearTimeout(this.delayid),this.delayid=0),this.timerid>0&&(clearTimeout(this.timerid),this.timerid=0),b.alone)return this.call_wasm_func(1),void _.emit("ManagerMsg","deal");this.delayid=setTimeout((function(){n.delayid=0,n.call_wasm_func(1);var e=n.AI.wasm_view.getUint16(0),t=new ArrayBuffer(7+e),i=new DataView(t),s=0;i.setUint8(s,6),s+=1,i.setUint32(s,n.all_players[0].playerid),s+=4,i.setUint16(s,n.netstep),s+=2;for(var a=0;a<e;a+=1)i.setUint8(s+a,n.AI.wasm_view.getUint8(2+a));_.emit("WsRequest","deal",t)}),1500*this.DelayNum())}}},{key:"onChoosed",value:function(e){var t=this;if(e.propagationStopped=!0,"Start"===e.detail)return this.Opt.pauseSystemEvents(!1),void(b.alone?_.emit("ManagerMsg","start"):_.emit("WsRequest","start"));if("Discard"!==e.detail){if("Leave"===e.detail)return this.Opt.pauseSystemEvents(!1),void(b.alone?f.loadBundle("Hall",(function(e,t){_.loadScene("GameHall")})):_.emit("WsRequest","leave",0));if("Change"===e.detail)return this.Opt.pauseSystemEvents(!1),void _.emit("WsRequest","leave",1);if("Ai"===e.detail)return this.all_players[0].isAi=!this.all_players[0].isAi,void(this.all_players[0].isAi?this.auto.getComponent(A).color=R:this.auto.getComponent(A).color=B);if("Quit"!==e.detail){if("Seat"===e.detail){if("Player0"===e.target.name){if(this.showout=!this.showout,this.showout){for(var i,s,a=0;a<this.gamers;a+=1)s=this.small_curAreas[a],(i=this.curAreas[a]).children.forEach((function(e){return e.setScale(t.scale,t.scale,1)})),this.relocation(i,s),this.showCards(s);for(var n,r=1;r<this.gamers;r+=1)n=this.outAreas[r],this.showCards(n)}else{for(var o,l,h=0;h<this.gamers;h+=1)l=this.curAreas[h],(o=this.small_curAreas[h]).children.forEach((function(e){return e.setScale(1,1,1)})),this.relocation(o,l),this.showCards(l);for(var d,c=1;c<this.gamers;c+=1)d=this.outAreas[c],this.showCards(d,!0)}return void this.ShowHand()}var u=Number(e.target.name.charAt(6));if(this.vpos=0,this.all_players[u].playerid===this.info.getComponent(M).selected())return this.info.getComponent(M).setInfo(0,""),void(this.info.active=!1);this.info.getComponent(M).setInfo(this.all_players[u].playerid,this.all_players[u].introduce);var p=this.all_players[u].node.getComponent(S),g=this.info.getComponent(S);return p.left<p.right?(g.left=p.left,g.right=.8-g.left):(g.right=p.right,g.left=.8-g.right),p.top<=p.bottom?(g.top=1-p.bottom,g.bottom=.8-g.top):(g.bottom=1-p.top,g.top=.8-g.bottom),void(this.info.active=!0)}}else null===this.quit.getComponent(m).spriteFrame?this.quit.getComponent(m).spriteFrame=this.quit_pic:(this.quit.getComponent(m).spriteFrame=null,x(V.msgbox.do_quit,null,void 0,"quit"))}else{var v=this.CardsSelected();if(0===v.length)return;this.Opt.pauseSystemEvents(!1),v.forEach((function(e,i){return t.AI.wasm_view.setUint8(i,e)})),this.call_wasm_func(5,v.length);var y=this.AI.wasm_view.getUint8(0);0===y?b.alone?_.emit("ManagerMsg","play",this.all_players[0].playerid,this.playstep,v,!1):this.SendCards(v):(this.Opt.resumeSystemEvents(!1),this.Handle_Wrong_Choose(y,v))}}},{key:"Countdown_Start",value:function(e){this.countdown=e,this.Opt.resumeSystemEvents(!1),this.Opt.getChildByName("Start").active=!1,this.Opt.getChildByName("Leave").active=!0,V.games[b.gamenum].random&&!b.super&&(this.Opt.getChildByName("Change").active=!0),this.CtStart(e)}},{key:"Deal",value:function(){var e=this;this.timerid=setTimeout((function(){e.timerid=0,e.call_wasm_func(3)}),350)}},{key:"Countdown_Discard",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=this.all_players[e].node.getComponent(S),a=this.frame.getComponent(S);a.left=s.left,a.right=s.right,a.top=s.top,a.bottom=s.bottom,this.countdown=t,0===e&&(this.Opt.resumeSystemEvents(!1),this.Opt.getChildByName("Discard").active=!0),this.CtDiscard(e,t,i)}},{key:"Discard",value:function(e){var t=this.all_players[e],i=[];this.call_wasm_func(11);for(var s=this.AI.wasm_view.getUint8(0),a=0;a<s;a+=1)i.push(this.AI.wasm_view.getUint8(1+a));b.alone||0!==e?_.emit("ManagerMsg","play",t.playerid,this.playstep,i,!1):this.SendCards(i)}},{key:"DelayNum",value:function(){var e=this.netstep%this.gamers+1;(e=this.myindex-e)<0&&(e+=this.gamers);for(var t=e;t>0;t-=1)this.all_players[this.gamers-t].playerid<7&&(e-=1);return e}},{key:"CardsSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handArea,t=e.children.findIndex((function(e){return 1!==e.scale.x})),i=-1===t?e.children.length:t;return e.children.filter((function(e,t){return t<i&&e.getComponent(I).selected})).map((function(e){return e.getComponent(I).face}))}},{key:"getFreeCard",value:function(e){for(var t=(e-1)*this.decks,i=this.decks-1;i>-1;i-=1)if(null===this.all_cards[t+i].node.parent)return t+i}},{key:"ShowHand",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.showout,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.handArea,s=i.children.length;if(0!==s){var a=i.children.findIndex((function(e){return 1!==e.scale.x})),n=-1===a?i.children.length:a,r=t?s:n,o=i.getComponent(u),l=this.car_height,h=.8*l,d=o.width-h,c=r>1?d/((r<<1)-2):0,m=1,f=h/4;c<f?0!==c&&(m=2,(c*=2)>f&&(c=f)):c=f;var p=1===m?r:r-(r>>>1),g=h/2+(p-1)*c,v=-o.height/2,y=v+.165*l;if(1===m)for(var _,w=0;w<r;w+=1)_=!1,w<n&&i.children[w].getComponent(I).selected&&(e?i.children[w].getComponent(I).selected=!1:(i.children[w].setPosition((w<<1)*c-g,y,0),_=!0)),_||i.children[w].setPosition((w<<1)*c-g,v,0);else{for(var C,A=-v-l,S=A-.165*l,k=0;k<p;k+=1)C=!1,k<n&&i.children[k].getComponent(I).selected&&(e?i.children[k].getComponent(I).selected=!1:(i.children[k].setPosition((k<<1)*c-g,A,0),C=!0)),C||i.children[k].setPosition((k<<1)*c-g,S,0);for(var b,V=p;V<r;V+=1)b=!1,V<n&&i.children[V].getComponent(I).selected&&(e?i.children[V].getComponent(I).selected=!1:(i.children[V].setPosition((V-p<<1)*c-g,y,0),b=!0)),b||i.children[V].setPosition((V-p<<1)*c-g,v,0)}if(r<s)for(var U=r;U<s;U+=1)i.children[U].setPosition(0,this.out_screen,0)}}},{key:"showCards",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=e.children.length;if(0!==s){var a=e.getComponent(u);if(i)e.children.forEach((function(e){return e.setPosition(0,t.out_screen,0)}));else{for(var n=e.children[0].scale.y*e.children[0].getComponent(u).height,r=.8*n,o=a.width-r,l=a.height-n,h=Math.floor(l/n/.45)+1,d=s>1?o/((s<<1)-2):0,c=r/4,m=1;d<c&&m<h&&0!==d;)d*=(m+=1)/(m-1);d>c&&(d=c);var f=m>1?l/((m<<1)-2):0,p=n/4;f>p&&(f=p);for(var g,v=m>1?Math.ceil(s/m):s,y=r/2+(v-1)*d,_=n/2+(m-1)*f,w=0,C=0,A=0;A<m;A+=1){for(g=_-n-(A<<1)*f,C=0;C<v&&w+C!==s;C+=1)e.children[w+C].setPosition((C<<1)*d-y,g,0);w+=v}}}}},{key:"relocation",value:function(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.ex,s=e.children.length,a=s-1;a>-1;a-=1)e.children[a].parent=i;for(var n=s-1;n>-1;n-=1)i.children[n].parent=t}},{key:"Notice",value:function(e){var t=new ArrayBuffer(12),i=new DataView(t),s=0;i.setUint8(s,43),s+=1,i.setUint8(s,1),s+=1,i.setUint32(s,e),s+=4,i.setUint32(s,this.all_players[0].playerid),s+=4,i.setUint16(s,this.netstep),s+=2,_.emit("WsRequest","msg",t)}},{key:"SendCards",value:function(e){var t=e.length,i=new ArrayBuffer(10+t),s=new DataView(i),a=0;s.setUint8(a,41),a+=1,s.setUint8(a,1),a+=1,s.setUint32(a,this.all_players[0].playerid),a+=4,s.setUint16(a,this.netstep),a+=2,s.setUint16(a,this.playstep),a+=2;for(var n=0;n<t;n+=1)s.setUint8(a+n,e[n]);a+=t,_.emit("WsRequest","msg",i)}},{key:"setPlayer",value:function(e,t,i){switch(i){case 1:this.all_players[e].labelTopLeft=String(t);break;case 2:this.all_players[e].labelTopRight=String(t);break;case 3:this.all_players[e].labelRight=String(t);break;case 4:this.all_players[e].labelLeft=String(t)}}},{key:"touchend",value:function(e){var t=e.target;e.propagationStopped=!0,e.getUIStartLocation(this.startVec2),this.startVec3.x=this.startVec2.x,this.startVec3.y=this.startVec2.y,this.startVec3.z=0,t.getComponent(u).convertToNodeSpaceAR(this.startVec3,this.startVec3),this.startVec2.x=this.startVec3.x,this.startVec2.y=this.startVec3.y,e.getUILocation(this.endVec2),this.endVec3.x=this.endVec2.x,this.endVec3.y=this.endVec2.y,this.endVec3.z=0,t.getComponent(u).convertToNodeSpaceAR(this.endVec3,this.endVec3),this.endVec2.x=this.endVec3.x,this.endVec2.y=this.endVec3.y;for(var i=-1,s=-1,a=t.children.findIndex((function(e){return 1!==e.scale.x})),n=-1===a?t.children.length:a,r=n-1;r>-1;r-=1)if(t.children[r].getComponent(u).getBoundingBox().contains(this.endVec2)){i=r;break}for(var o=n-1;o>-1;o-=1)if(t.children[o].getComponent(u).getBoundingBox().contains(this.startVec2)){s=o;break}if(-1!==s&&-1!==i){if(i<s){var l=s;s=i,i=l}var h=.165*this.car_height;this.startVec3.set(0,h,0),this.endVec3.set(0,-h,0);for(var d=s;d<=i;d+=1)t.children[d].getComponent(I).selected?(t.children[d].getComponent(I).selected=!1,t.children[d].translate(this.endVec3)):(t.children[d].getComponent(I).selected=!0,t.children[d].translate(this.startVec3))}}},{key:"onResized",value:function(){this.car_height=.2*this.node.getComponent(u).height;var e=this.car_height,t=.8*e;this.all_cards.forEach((function(i){return i.node.getComponent(u).contentSize.set(t,e)}))}},{key:"AfterRoomReady",value:function(){_.off("Ready"),_.on("ManagerMsg",this.onManagerMsg,this),this.all_players[0].SetPlayerInfo(b.playerid,b.nickname,b.introduce,b.head),b.super&&_.emit("ManagerMsg","create")}},{key:"CtStart",value:function(e){var t=this;if(this.countdown<1){if(this.Opt.pauseSystemEvents(!1),this.timer.getComponent(A).string="",b.alone)return void _.emit("ManagerMsg","start");this.delayid=setTimeout((function(){t.delayid=0,_.emit("WsRequest","start")}),1e3*this.DelayNum())}else{this.countdown+1<e&&(this.Opt.getChildByName("Start").active=!0),this.timer.getComponent(A).string=String(this.countdown);this.timerid=setTimeout((function(){t.timerid=0,t.countdown-=1,t.CtStart(e)}),1e3)}}},{key:"CtDiscard",value:function(e,t,i){var s=this;if(this.countdown<1)0===e&&(this.Opt.pauseSystemEvents(!1),this.timer.getComponent(A).string=""),i&&(this.all_players[e].isAi=!0,0===e&&(this.auto.getComponent(A).color=R)),this.Discard(e);else{if(0===e&&(this.timer.getComponent(A).string=String(this.countdown)),this.all_players[e].isAi&&this.countdown+1<t)return void this.Discard(e);this.timerid=setTimeout((function(){s.timerid=0,s.countdown-=1,s.CtDiscard(e,t,i)}),1e3)}}},{key:"preHandlePlay",value:function(e,t,i,s){(t===this.last_get_playstep&&s||t!==this.last_get_playstep&&!s)&&(this.timerid>0&&(clearTimeout(this.timerid),this.timerid=0),this.handle_play(this.all_players.findIndex((function(t){return t.playerid===e})),i,s))}}]),l}(k))||E);o._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/Room', 'chunks:///_virtual/Room'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});